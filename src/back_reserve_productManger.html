<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./css/style.css">
    <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css"/>
    <title>私廚商品上架</title>
</head>
<body>
    <!-- ============== 缺搜尋BAR ============== -->
    <div class="back_reserve_productManger fulid_wrapper">
        <div class="backwrapper">
            <header>
                @@include('layout/back_header.html')
            </header>

            <div class="container">
                <main class="right_content">
                    <section class="section1">
                        <!-- form -->
                        <div class="back_from">
                            <h4 class="h4 green-1">私廚商品上架</h4>
                            <div class="back_from_wrapper">
                                    <!-- row-1 -->
                                <div class="grid_container">
                                    <div class="grid_item">商品編號</div>
                                    <div class="grid_item">分類</div>
                                    <div class="grid_item">品名</div>
                                    <div class="grid_item">售價</div>
                                    <!-- <div class="grid_item">庫存</div> -->
                                    <div class="grid_item">狀態</div>
                                </div>

                                <!-- row-2 -->
                                <div class="grid_container">
                                    <div class="grid_item checked">SM001</div>
                                    <div class="grid_item">私廚菜單</div>
                                    <div class="grid_item">手沖牛肉湯</div>
                                    <div class="grid_item">$280</div>
                                    <!-- <div class="grid_item">25</div> -->
                                    <div class="grid_item">
                                        <label class="switch">
                                            <input type="checkbox" class="switch_btn" checked>
                                            <span class="slider"></span>
                                            <p class="slider_content">上架</p>
                                        </label>
                                    </div>
                                </div>

                                <!-- row-3 -->
                                <div class="grid_container">
                                    <div class="grid_item checked">S001</div>
                                    <div class="grid_item">單品</div>
                                    <div class="grid_item">蛤蠣煮物院雞湯</div>
                                    <div class="grid_item">$280</div>
                                    <!-- <div class="grid_item">25</div> -->
                                    <div class="grid_item">
                                        <label class="switch">
                                            <input type="checkbox" class="switch_btn" checked>
                                            <span class="slider"></span>
                                            <p class="slider_content">上架</p>
                                        </label>
                                    </div>
                                </div>

                                <!-- row-4 -->
                                <div class="grid_container">
                                    <div class="grid_item checked">S001</div>
                                    <div class="grid_item">單品</div>
                                    <div class="grid_item">日暈雙月奶蓋</div>
                                    <div class="grid_item">$280</div>
                                    <!-- <div class="grid_item">5</div> -->
                                    <div class="grid_item">
                                        <label class="switch">
                                            <input type="checkbox" class="switch_btn" checked>
                                            <span class="slider"></span>
                                            <p class="slider_content">上架</p>
                                        </label>
                                    </div>
                                </div>

                                <!-- row-5 -->
                                <div class="grid_container">
                                    <div class="grid_item checked">S001</div>
                                    <div class="grid_item">湯品</div>
                                    <div class="grid_item">手沖牛肉湯</div>
                                    <div class="grid_item">$280</div>
                                    <!-- <div class="grid_item">25</div> -->
                                    <div class="grid_item">
                                        <label class="switch">
                                            <input type="checkbox" class="switch_btn" checked>
                                            <span class="slider"></span>
                                            <p class="slider_content">上架</p>
                                        </label>
                                    </div>
                                </div>

                                
                            </div><!-- wrapper -->
                        </div><!-- back_from -->
                        
                        <!-- 頁碼-->
                        <!-- <div class="page">
                            <ul class="page_ul">
                            <li><a href="#">1</a></li>
                            <li><a href="#">2</a></li>
                            <li><a href="#">3</a></li>
                            <li><a href="#">4</a></li>
                            </ul>
                        </div> -->
                    </section><!-- section1 -->
                </main>
                @@include('layout/back_footer.html')
            </div><!-- container -->
        </div>
        <div class="section_reserve" id="reserve_producetManger">
            <div class="reserve_top">
                <p>新增私廚菜單</p>
            </div>
            <div class="reserve_info">
                <h6>商品名稱：<input placeholder="苑 春堂套餐"></h6>
                <h6>商品分類：<input placeholder="私廚菜單"></h6>
                <h6>商品編號：<input placeholder="SM001"></h6>
            </div>
            <div class="reserve_type">
                <ul>
                    <li>種類：湯品 +</li>
                    <li>種類：前菜 -
                        <div class="type_content">
                            <h6 class="name">品名：<input placeholder="奶香牛肝菌野菇濃湯                          (5/25)"></h6>
                            <h6 class="number">編號：<input placeholder="BR002"></h6>
                            <h6 class="price">價格：<input placeholder="$250"></h6>
                        </div>
                    </li>
                    <li>種類：刺身 +</li>
                    <li>種類：主食 +</li>
                    <li>種類：甜點 +</li>
                    <li>種類：飲品 +</li>
                    <li>種類：單品 +</li>
                </ul>
            </div>
            <button class="section_reserve_btn">儲存</button>
        </div>
    </div>

    <script src="./js/vender/Jquery/jquery-3.6.1.js"></script><!-- JQ -->
    <script
        type="module"
        src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script><!-- icon_cdn -->
    <script
        nomodule="nomodule"
        src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script><!-- icon_cdn -->
        <script src="./js/back_page/back_nav/back_nav.js"></script><!-- 導覽列 -->
        <script src="js/vender/Vue/vue.global.js"></script>
        <script>
            const app = Vue.createApp({
            data() {
                return {
                    APIdata:{
                    },
                };
                },
                computed:{

                },
                methods:{
                    // api start
                    getSetPrice(){
                        fetch('php/reserveAPI/getSetPriceAPI.php')
                        .then(response =>{
                            return response.json();
                        })
                        .then( data =>{
                            // 將套餐資訊放入APIData (圖片,售價,ID...)
                            // console.log(data)
                            data.forEach(el => {
                                console.log(el)
                                if(this.APIdata.hasOwnProperty(`set${el.id}`)){
                                    this.APIdata[`set${el.id}`] = {}
                                }
                                this.APIdata[`set${el.id}`] = el 
                            });
                            this.getSetdishDetail();
                        }).catch(err=>{
                            console.log(err)
                        })
                    },

                    // 取得套餐內商品資訊 及 服務資訊
                    getSetdishDetail(){
                        fetch('php/reserveAPI/setAPI.php')
                        .then(function(response) {
                            return response.json();
                        })
                        .then((res)=>{
                          
                            res.forEach(data => {
                                // 單品 
                                if(data.SetID === null && data.dishType =="服務"){
                                    // this.APIdata.other
                                    if(this.APIdata.serve == undefined){
                                        this.APIdata.serve =[];
                                    }
                                    this.APIdata.serve.push(data);
                                }else{
                                     // 塞A,B,C 套餐資訊
                                    if(!this.APIdata[`set${data.SetID}`].hasOwnProperty(`dish`)){
                                        this.APIdata[`set${data.SetID}`][`dish`] = {};
                                    }
                                    // console.log(data.dishType)
                                    if(!this.APIdata[`set${data.SetID}`].dish.hasOwnProperty(`${data.dishType}`)){
                                        this.APIdata[`set${data.SetID}`].dish[`${data.dishType}`] =[];
                                    }
                                    this.APIdata[`set${data.SetID}`].dish[`${data.dishType}`].push(data);
                                }
                               
                            })
                            
                            // console.log(this.APIdata.set1.dish)
                            // console.log(this.APIdata.set2.dish)
                            // console.log(this.APIdata.set3.dish)

                        }).catch(error=>{
                            console.log(error)
                        });
                    },

                     // 取得單點商品資訊
                    getOtherDish(){
                        fetch('php/reserveAPI/otherAPI.php')
                            .then(response =>{
                                return  response.json();
                            })
                            .then( data =>{
                                console.log(data)
                                if(this.APIdata.other == undefined){
                                        this.APIdata.other =[];
                                }
                                data.forEach((data_el)=>{  
                                    console.log(data_el.price)
                                    let obj={
                                        id:data_el.id,
                                        dishName:data_el.disName,
                                        dishType:data_el.dishType,
                                        price:data_el.price,
                                        qty:0
                                    }
                                    this.APIdata.other.push(obj);
                                   
                                })
                                 
                                   
                            }).catch(err=>{
                                console.log(err)
                            })
                    },
                    // api end
                },

                watch:{

                },

                components:{

                },

                mounted(){
                    this.getSetPrice();
                    this.getOtherDish();
                    // this.getSetdishDetail();
                }
            });
            app.mount("#reserve_producetManger");
        </script>
    <script>
        // const switchBtn = document.querySelectorAll(".switch_btn");
        // const sliderContent = document.querySelectorAll(".slider_content");
        // // console.log(switchBtn);

        // for(let i=0; i < switchBtn.length; i++){
        //     // console.log(i)
        //     switchBtn[i].addEventListener("click", function(){
        //         console.log(this.checked); // ture /false
        //         console.log(i); 
        //         console.log(this)

        //         if (this.checked == true) {

        //             $(this).closest("label").find(".slider_content").text('上架');
        //         } else{
        //             $(this).closest("label").find(".slider_content").text('下架');
        //         }
        //     });
        // }
    </script>
</body>
</html>