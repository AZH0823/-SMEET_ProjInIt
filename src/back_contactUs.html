<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css"
    />
    <link rel="stylesheet" href="./css/style.css" />

    <title>QAç®¡ç†</title>
  </head>
  <body>
    <!-- ============== ç¼ºæœå°‹BAR ============== -->
    <div class="back_contactUs fulid_wrapper">
      <div class="backwrapper">
        <header>@@include('layout/back_header.html')</header>

        <div class="container">
          <main class="right_content">
            <section class="section1">
              <!-- form -->
              <div class="back_from">
                <h4 class="h4 green-1">è¯çµ¡æˆ‘å€‘</h4>
                <div class="back_from_wrapper">
                  <!-- row-1 -->
                  <div class="grid_container">
                    <div class="grid_item">é›»å­ä¿¡ç®±</div>
                    <div class="grid_item">æ—¥æœŸ</div>
                    <div class="grid_item">å»ºè­°äº‹é …</div>
                    <div class="grid_item">å…§å®¹</div>
                    <div class="grid_item">å›è¦†ç‹€æ…‹</div>
                  </div>

                  <!-- row-2 -->
                  <div class="grid_container" v-for="contact in Contactlist">
                    <div class="grid_item checked" @click="popon_open(contact)">
                      <!-- a10109990@g... -->
                      {{contact.Email}}
                    </div>
                    <div class="grid_item">
                      <!-- 2022/01/13 -->
                      {{contact.ReleaseDate}}
                    </div>
                    <div class="grid_item">
                      <!-- åˆä½œ -->
                      {{contact.Category}}
                    </div>
                    <div class="grid_item">
                      <!-- ç¬¬ä¸€æ¬¡é«”é©—æ„Ÿè¦ºå¾ˆæœ‰å°Šæ¦®... -->
                      <!-- {{contact.SuggestContent}} -->
                      {{subData(contact.SuggestContent)}}
                    </div>
                    <div class="grid_item gray">
                      <!-- æœªå›è¦† -->
                      <p v-if="contact.Condition == 0">æœªè®€å–</p>
                      <p v-if="contact.Condition == 1">å·²è®€å–</p>
                      <!-- {{contact.Condition}} -->
                    </div>
                  </div>
                </div>
              </div>
            </section>
          </main>
          <!-- popon start -->
          <div id="myModal" class="modal" v-if="Popon_date.isEdit" @click="outsideClose" >
            <!-- å¼¹çª—å†…å®¹ -->
            <div class="modal-content" @click.stop>
              <span class="close"></span>
              <div class="contactus_top">
                <h6>è¨Šæ¯å›è¦†</h6>
              </div>
              <div class="contactus_mail">
                <h6>
                  <!-- é›»å­ä¿¡ç®± : a1235990@gmail.com -->
                  é›»å­éƒµç®±:{{Popon_date.Email}}
                </h6>
              </div>
              <div class="contactus_date">
                <h6>
                  <!-- æ—¥æœŸï¼š2022/01/13 -->
                  æ—¥æœŸ:{{Popon_date.ReleaseDate}}
                </h6>
              </div>
              <div class="contactus_name_phone">
                <h6>å§“å:{{Popon_date.Name}}</h6>
                <h6>é›»è©±:{{Popon_date.Phone}}</h6>
              </div>
              <div class="contactus_type">
                <h6>å»ºè­°äº‹é …:{{Popon_date.Category}}</h6>
              </div>
              <div class="contactus_content">
                <h6>æ‚¨çš„å»ºè­°</h6>
                <p>
                  <!-- Hi ç§è¦“æ‚¨å¥½ï¼<br />æˆ‘æ˜¯HoShaä¸»ç†äººYumiï¼Œæˆ‘å€‘åœ˜éšŠä¸€ç›´éå¸¸å–œæ­¡è²´å“ç‰Œï¼Œå¸Œæœ›èˆ‡è²´å“ç‰Œæœ‰åˆä½œçš„æ©Ÿæœƒï¼æˆ‘å€‘<br />æ˜¯æ–¼2022å¹´å‰µç«‹çš„å’Œæœå“ç‰Œ-HoShaï¼Œä¸»è¦çš„è²©å”®æ—¥æœ¬å¤å…¸æ–‡è—ç›¸é—œï¼Œå¾ˆå¸Œæœ›èƒ½èˆ‡è²´å“<br />ç‰Œåˆä½œåˆ°åºœæœå‹™çš„å»šå¸«ç©¿æ­åŠé“å…·ç§Ÿå€Ÿã€‚æœŸå¾…æ”¶åˆ°å›è¦†ï¼Œè¬è¬ğŸ™ğŸ™<br />HoSha
                                    å®˜ç¶²â†“<br />https://www.hosha.com/<br />by Yumi -->
                  {{Popon_date.SuggestContent}}
                </p>
                
                <button class="contactus_content_btn" 
                :value="Popon_date.ID"
                v-if="Popon_date.Condition == 0 "
                @click="updateContactCondition">å„²å­˜</button>
              </div>
            </div>
          </div>
          <!-- popon end -->
          @@include('layout/back_footer.html')
        </div>
      </div>
    </div>
    <script src="./js/vender/Vue/vue.global.prod.js"></script>
    <script src="./js/vender/Jquery/jquery-3.6.1.js"></script>
    <!-- render ajax -->
    <script>
      let app1 = Vue.createApp({
        data() {
          return {
            Contactlist: [],
            Popon_date: {
              isEdit: false,
              ID:"",
              Email: "",
              ReleaseDate: "",
              Name: "",
              Phone: "",
              Category: "",
              SuggestContent: "",
              Condition: "",
            },
          };
        },
        created() {
          this.contactrender();
        },
        methods: {
          contactrender() {
            let _this = this;

            $.ajax({
              method: "POST",
              url: "php/frontpage/back_contactus.php",
              data: {},

              dataType: "json",
              success: function (response) {
                // console.log(response);
                response.forEach((element) => {
                  // console.log(element);
                  element.ReleaseDate = element.ReleaseDate.substr(0, 10);
                  // if (element.Condition == 1) {
                  //   element.Condition = "å·²è®€å–";
                  // } else {
                  //   element.Condition = "æœªè®€å–";
                  // }
                  // if (element.SuggestContent.length <= 10) {
                  //   _this.Contactlist.push(element);
                  // } else {                      
                  //   _this.Contactlist.push(element);
                  // }
                  _this.Contactlist.push(element);
                  // element.SuggestContent.substr(0, 11) + "...";
                });
              },
              error: function (exception) {
                alert("ç™¼ç”ŸéŒ¯èª¤: " + exception.status);
              },
            });
          },
          subData(e){
              // element.SuggestContent.substr(0, 11) + "...";
              let str = e.substr(0, 11) + "..."
              console.log();
              return str;
          },
          popon_open(contact) {
            // console.log(contact);
            if(!this.Popon_date.isEdit){
              this.Popon_date={}
              this.Popon_date.isEdit = true
              this.Popon_date.ID = contact.ID;
              this.Popon_date.Email = contact.Email;
              this.Popon_date.ReleaseDate = contact.ReleaseDate;
              this.Popon_date.Name = contact.Name;
              this.Popon_date.Phone = contact.Phone;
              this.Popon_date.Category = contact.Category;
              this.Popon_date.SuggestContent = contact.SuggestContent;
              this.Popon_date.Condition = contact.Condition
            }else{

            }
            
          },
        
          outsideClose(){
            console.log(`close`)
            this.Popon_date.isEdit = false;

          },
          updateContactCondition(e) {
            // console.log(QA);
            let id = e.target.value;
            let status = 1;
            let _this = this

            $.ajax({
              method: "POST",

              url: "./php/backpage/back_contact_update.php",

              data: {
                Contact_ID: id,
                Contact_Condition: status,
              },

              dataType: "text",

              success: (response) => {
                console.log(response);
                _this.outsideClose();
                _this.reload()

              },

              error: (exception) => {
                alert("æ•¸æ“šè¼‰å…¥å¤±æ•—: " + exception.status);
              },
            });
          },
          reload() {
            window.location.assign(window.location.href)
          }

        },
      });
      app1.mount(".container");
    </script>
  </body>
</html>
